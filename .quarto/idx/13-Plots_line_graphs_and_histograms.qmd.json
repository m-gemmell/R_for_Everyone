{"title":"Histograms and Line graphs","markdown":{"headingText":"Histograms and Line graphs","containsRefs":false,"markdown":"```{r, fig.align = 'center',out.width= '20%', echo=FALSE }\nknitr::include_graphics(path = \"figures/palette.png\", auto_pdf = TRUE)\n```\n\nIn this chapter we will learn how to create two different types of plots; Histograms and Line graphs. I have chosen these two types of plots first as they are relatively straightforward to create.\n\nCreate and use the directory \"Chapter_13-16\" as the working directory for this chapter. Additionally create a new script called \"Histograms_n_line_graphs.R\" for this chapter.\n\n## Histogram\n```{r, fig.align = 'center',out.width= '20%', echo=FALSE }\nknitr::include_graphics(path = \"figures/histogram.png\", auto_pdf = TRUE)\n```\nA histogram consists of bars showing the frequency of variables present in numbered ranges (bins). This allows you to see an approximate distribution of numerical data.\n\nWe are starting with histograms as the __function__ `hist()`, which creates a histogram, only requires one __vector__. \n\nThe following code creates a numerical __vector__ and then produces a histogram. When you run the `hist()` command a plot should appear in your __\"Plots\" pane__ of the __MISC window__.\n\n```{r eval=FALSE}\nnumeric_vec <- 1:40\nhist(numeric_vec)\n``` \n\nYou will notice that the histogram is not very interesting. There are 8 bars all of equal size. This is because we plotted the numbers from 1-40 so numbers 1-5 are counted in the first bar/bin, 6-10 in the second bar/bin and so forth. To get a more interesting histogram we will create a more interesting __vector__.\n\nHistograms are good to see the numerical distribution of data. In this case we are going to look at the number of cities (with greater than 300,000 population) in EU countries (https://en.Wikipedia.org/wiki/List_of_cities_in_the_European_Union_by_population_within_city_limits).\n\nThe first step is to create a __vector__ with the numbers of cities in EU countries, however we won't know what countries these correspond to yet. Then we will create a histogram and set the colour of the bars with the option `col = `.\n```{r eval=FALSE}\neu_cities <- c(1, 1, 3, 1, 2,\n               2, 1, 1, 6, 22,\n               2, 1, 1, 10, 1,\n               1, 4, 9, 1, 7,\n               1, 12, 3)\nhist(eu_cities, col = \"orange\")\n```\n\nWith that histogram we can see that most EU countries have 1-5 cities with a few having a much larger amount. As most of the time you will not be working with just __vectors__ let us make a __data frame__ containing the number of EU cities and the population of the EU countries.\n\nThe population numbers will be in millions to the closest 1 decimal place and consist of the 2020 Eurostat figures from: https://en.Wikipedia.org/wiki/List_of_European_Union_member_states_by_population\n\n```{r eval=FALSE}\neu_country_names <- c(\"Austria\", \"Belgium\", \"Bulgaria\", \"Croatia\", \"Czech Republic\", \n                      \"Denmark\", \"Estonia\", \"Finland\", \"France\", \"Germany\", \n                      \"Greece\", \"Hungary\", \"Ireland\", \"Italy\", \"Latvia\", \n                      \"Lithuania\", \"Netherlands\", \"Poland\", \"Portugal\", \"Romania\", \n                      \"Slovakia\", \"Spain\", \"Sweden\")\neu_pop <- c(8.9, 11.5, 7.0, 4.1, 10.7,\n            5.8, 1.3, 5.5, 67.1, 83.2,\n            10.7, 9.8, 5.0, 60.2, 1.9,\n            2.8, 17.4, 38.0, 10.3, 19.3,\n            5.5, 47.3, 10.3)\neu_df <- data.frame(eu_cities,eu_pop,\n                    row.names = eu_country_names)\n```\n\nWe will quickly create a histogram for the population numbers. We'll make the bar colours purple and we'll make the x axis label \"2020 Eurostat population number in millions\" with the `xlab = ` option.\n\n```{r eval=FALSE}\nhist(eu_df$eu_pop, col = \"purple\",\n     xlab = \"2020 Eurostat population number in millions\")\n```\n\nWe have a similar pattern as with the number of cities (most have low numbers, some high numbers). \n\nWe can quickly check if the countries with the high number of cities also have the high populations by creating a new column equal to population / number of cities. This will give us nice ratios. We can plot the distribution of these ratios in a histogram.\n\nFor this histogram we will also add a title to the plot with the option `main = `. Additionally we will choose a different colour. Having different colours and main titles makes it easier for you to instantly know which plot you are looking at.\n\n```{r eval=FALSE}\n#Create ratio column\neu_df$pop_cities_ratio <- eu_df$eu_pop / eu_df$eu_cities\n#Histogram of ratio distribution\nhist(eu_df$pop_cities_ratio, col = \"blue\",\n     xlab = \"Ratio of population (millions) to numer of cities\",\n     main = \"EU countries ratio of population to cities\")\n```\n\nLooking at the plot most countries seem to have a ratio of 2-6 million citizens to every city. However, it is still not a perfect match with some lower and some higher ratios. Of course a result is a result and we have hopefully found out something new.\n\nBefore we go onto line graphs I'll show you how to look at your previous plots. In the __Plots pane__ of the __MISC window__ there are two arrows on the top left. You can use these to go backwards and forwards between the plots you have created since you opened RStudio. Give it a go!\n\n```{r, fig.align = 'center',out.width= '40%', echo=FALSE }\nknitr::include_graphics(path = \"figures/RStudio_plot_pane_arrows.png\", auto_pdf = TRUE)\n```\n\n## Line graphs\n```{r, fig.align = 'center',out.width= '20%', echo=FALSE }\nknitr::include_graphics(path = \"figures/line_graph.png\", auto_pdf = TRUE)\n```\nLine graphs are perfect for showing change over time. Knowing this we'll go back to a data set we have touched before, the file \"UK_retail.tsv\" from Chapter 8. This file showed the success of four different retail sectors in the UK from September 2017 to September 2020.\n\n### Read in data\nFirst step is to __read__ in the data from the \"Chapter_8_files\" directory. Once the __data frame__ is created we will remove all non 2020 information.\n\n__Note__: The `../` below represents going up one directory. I.e. going up from your current working directory (\"Chapter_13-16\") to the main directory so it can be directed to \"Chapter_8_files\".\n\n```{r eval=FALSE}\nretail_df <- read.csv(\"../Chapter_8_files/UK_retail.tsv\", \n                      sep = \"\\t\", row.names = 1, \n                      check.names = FALSE)\nretail_df <- retail_df[29:37,]\n```\n\nBefore we continue have a look at the __data frame__ and make sure you are comfortable with what it contains. \n\n### Plotting a line graph\nWe are going to plot the entire information for the Food sector. We will use the __function__ `plot()` with the option `type = \"l\"`. This will produce a plot of type \"line\" (`\"l\"`).\n\nThis requires we provide a numeric __vector__ for the x axis (option `x = `) and the y axis (option `y = `). Currently our month and year information is in the row names as strings. \n\nTherefore before we plot the information we will create a new column called \"time_point\" with the numbers 1 to the number of rows. We will carry this out with the __function__ `nrow()` which produces one number equal to the number of rows in the specified __data frame__. \n\nWe won't use it here but the __function__ `ncol()` is similar to `nrow()` but for the number of columns.\n\n```{r eval=FALSE}\n#Produce time_point column\nretail_df$time_point <- 1:(nrow(retail_df))\n#Produce line plot of the food sector over time point.\nplot(y = retail_df$Food, retail_df$time_point, type = \"l\")\n```\n\n### Adding lines to a plot\nThis is looking decent but you normally want more than one line in a line graph. Thankfully we can do this with the __function__ `lines()`. We can add the other three sectors to the line graph like below:\n\n__Tip__: Remember to use tab completion to auto fill __function__, __variable__, and column names as well as for __function__ options.\n```{r eval=FALSE}\nlines(y = retail_df$`Non-food`, x = retail_df$time_point)\nlines(y = retail_df$`Non-store`, x = retail_df$time_point)\nlines(y = retail_df$Fuel, x = retail_df$time_point)\n```\n\nWe have created the line graph with all the sectors. However all the data is not visible.\n\n### Axis limits\nTo fix this we need to make sure all the data is within the graph. When the `plot()` __function__ was run it created the y limits based on the Food sector which has a minimum and maximum value of 101.5 and 111.3. Unfortunately the other sectors barely fit in this range.\n\nTo prevent this issue we can use the `plot()` option of `ylim = `. This option is provided with a __vector__ of 2 numbers. The first number is where the y axis will start. The second number is where the y axis will end.\n\nTo find out where the y axis will end we will use the `max()` __function__. This will give one number which is equal to the highest number found in a numeric __object__. This __object__ can be a __scalar__, __vector__, or a __data frame__.\n\nWe will use the __function__ `min()` just like `max()` to find where the y axis should start.\n\nLet us therefore recreate the plot with an appropriate y axis range.\n\n__Note__: Some times it is more appropriate to set values for the y limits (i.e. starting the y axis at 0). In this case 100 is the baseline value so it would be inappropriate to start at 0.\n\n__Tip__: Copying your past code in the script editor and editing it will make the following examples a lot quicker to carry out.\n```{r eval=FALSE}\n#Minimum and maximum for y axis\n#Provide the function a subset of the retail_df\n#so it is not using the time_point column\nmin_y <- min(retail_df[,1:4])\nmax_y <- max(retail_df[,-5])\n#Produce line plot of the food sector over time point.\n#Set y limits (min,max)\nplot(y = retail_df$Food, retail_df$time_point, type = \"l\",\n     ylim = c(min_y,max_y))\n#Add lines\nlines(y = retail_df$`Non-food`, x = retail_df$time_point)\nlines(y = retail_df$`Non-store`, x = retail_df$time_point)\nlines(y = retail_df$Fuel, x = retail_df$time_point)\n```\n\nGreat! That is much better. We can now see that two lines fall after time_point 2 whilst one increases. \n\n### Axis labels\nNumbers on the x axis are not ideal in this case. We will therefore use the `axis()` function to set our own x axis labels. We will use the following options for this:\n\n- `1`: The first option to `axis()` indicates the location of the axis labels. `1` indicates they will be located on the x axis (below).\n- `at = retail_df$time_point`: This indicates where the points tic marks will be drawn.\n- `labels = row.names(retail_df)`: A character __vector__ for the labels to be placed at the tick marks.\n\nFor more info for `axis()` run the command `?axis` to see its help page.\n\nTo use the `axis()` __function__ correctly we need to make sure there are no preexisting labels and tick marks on the x axis or else the new labels will go on top of the old. To do this we provide the `plot()` __function__ with the option `xaxt ='n'`, i.e. no x axis ticks.\n\n```{r eval=FALSE}\n#Produce line plot of the food sector over time point.\n#Ensure x axis ticks and labels are not displayed\nplot(y = retail_df$Food, retail_df$time_point, type = \"l\",\n     ylim = c(min_y,max_y), xaxt = 'n')\n#Add row names (month and date strings) as x axix labels\naxis(1, at = retail_df$time_point, labels = row.names(retail_df))\n#Add lines\nlines(y = retail_df$`Non-food`, x = retail_df$time_point)\nlines(y = retail_df$`Non-store`, x = retail_df$time_point)\nlines(y = retail_df$Fuel, x = retail_df$time_point)\n```\n\nWhen the plot is generated there may be only some labels showing for the x axis. If you would like to show them all increase the size of the __MISC window__.\n\n### Plot titles\nBefore we colour the lines different colours, let us add a main title and provide the x and y axis with better titles.\n```{r eval=FALSE}\n#Produce line plot of the food sector over time point.\n#Add main, x, and y titles\nplot(y = retail_df$Food, retail_df$time_point, type = \"l\",\n     ylim = c(min_y,max_y), xaxt = 'n',\n     main = \"Performance of UK retail sectors over 2020\",\n     ylab = \"Seasonally adjusted volume sales\",\n     xlab = \"Month and Year\")\n#Add row names (month and date strings) as x axix labels\naxis(1, at = retail_df$time_point, labels = row.names(retail_df))\n#Add lines\nlines(y = retail_df$`Non-food`, x = retail_df$time_point)\nlines(y = retail_df$`Non-store`, x = retail_df$time_point)\nlines(y = retail_df$Fuel, x = retail_df$time_point)\n```\n\n### Line colours\nNext we will colour the lines differently to differentiate the retail sectors. We carry this out with the `col = ` options for `plot()` and `lines()`.\n```{r eval=FALSE}\n#Produce line plot of the food sector over time point.\n#Include the colour red for the bars\nplot(y = retail_df$Food, retail_df$time_point, type = \"l\",\n     ylim = c(min_y,max_y), xaxt = 'n',\n     main = \"Performance of UK retail sectors over 2020\",\n     ylab = \"Seasonally adjusted volume sales\",\n     xlab = \"Month and Year\",\n     col = \"red\")\n#Add row names (month and date strings) as x axix labels\naxis(1, at = retail_df$time_point, labels = row.names(retail_df))\n#Add lines with different colours\nlines(y = retail_df$`Non-food`, x = retail_df$time_point, col = \"blue\")\nlines(y = retail_df$`Non-store`, x = retail_df$time_point, col = \"green\")\nlines(y = retail_df$Fuel, x = retail_df$time_point, col = \"purple\")\n```\n\n### Plot legend\nWe are almost there! The one thing we are missing now is a legend so we can quickly see what colour represents what sector.\n\nThis can be carried out by using the __function__ `legend()` after the plot is created. In this case the __function__ is run with the following options:\n\n- `x = \"topleft\"`: The legend will be placed in the top left of the plot.\n- `legend = colnames(retail_df[,1:4])`: This dictates the labels that will be in the legend.\n- `col = c(\"red\",\"blue\",\"green\",\"purple\")`: This indicates the matching colours for the labels.\n- `lty = 1`: This indicates that the colours will be presented as lines of type 1.\n\n```{r eval=FALSE}\nlegend(x = \"topleft\",\n       legend = colnames(retail_df[,1:4]),\n       col = c(\"red\",\"blue\",\"green\",\"purple\"),\n       lty = 1)\n```\n\nThat is a good amount to go through. The next chapter will go into scatter plots and box plots. If you have time read through the above again and possibly try to create a histogram or line plot with one of the data sets from previous chapters.\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"13-Plots_line_graphs_and_histograms.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.340","editor":"source","theme":"cosmo","max-width":"3000px","toc-location":"left","toc-title":"In this chapter","margin":0,"page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}