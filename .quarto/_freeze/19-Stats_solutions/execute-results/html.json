{
  "hash": "787e4d834950fc59cf923bc667daf813",
  "result": {
    "markdown": "# Stats solutions\n\n## World happiness report solutions\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](figures/world_happiness_solutions.png){fig-align='center' width=20%}\n:::\n:::\n\n1. Read in the file\n\n::: {.cell}\n\n```{.r .cell-code}\nhappy_df <- read.csv(\"Chapter_17-18/world_happiness_report_2016.csv\", \n                      check.names = FALSE,\n                      stringsAsFactors = TRUE,\n                      sep = \",\"\n                      )\n```\n:::\n\n\n2. Answer the following questions using the output from one __function__:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(happy_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Country                                Region   Happiness Rank  \n Afghanistan:  1   Sub-Saharan Africa             :38   Min.   :  1.00  \n Albania    :  1   Central and Eastern Europe     :29   1st Qu.: 40.00  \n Algeria    :  1   Latin America and Caribbean    :24   Median : 79.00  \n Angola     :  1   Western Europe                 :21   Mean   : 78.98  \n Argentina  :  1   Middle East and Northern Africa:19   3rd Qu.:118.00  \n Armenia    :  1   Southeastern Asia              : 9   Max.   :157.00  \n (Other)    :151   (Other)                        :17                   \n Happiness Score Lower Confidence Interval Upper Confidence Interval\n Min.   :2.905   Min.   :2.732             Min.   :3.078            \n 1st Qu.:4.404   1st Qu.:4.327             1st Qu.:4.465            \n Median :5.314   Median :5.237             Median :5.419            \n Mean   :5.382   Mean   :5.282             Mean   :5.482            \n 3rd Qu.:6.269   3rd Qu.:6.154             3rd Qu.:6.434            \n Max.   :7.526   Max.   :7.460             Max.   :7.669            \n                                                                    \n Economy (GDP per Capita)     Family       Health (Life Expectancy)\n Min.   :0.0000           Min.   :0.0000   Min.   :0.0000          \n 1st Qu.:0.6702           1st Qu.:0.6418   1st Qu.:0.3829          \n Median :1.0278           Median :0.8414   Median :0.5966          \n Mean   :0.9539           Mean   :0.7936   Mean   :0.5576          \n 3rd Qu.:1.2796           3rd Qu.:1.0215   3rd Qu.:0.7299          \n Max.   :1.8243           Max.   :1.1833   Max.   :0.9528          \n                                                                   \n    Freedom       Trust (Government Corruption)   Generosity    \n Min.   :0.0000   Min.   :0.00000               Min.   :0.0000  \n 1st Qu.:0.2575   1st Qu.:0.06126               1st Qu.:0.1546  \n Median :0.3975   Median :0.10547               Median :0.2225  \n Mean   :0.3710   Mean   :0.13762               Mean   :0.2426  \n 3rd Qu.:0.4845   3rd Qu.:0.17554               3rd Qu.:0.3119  \n Max.   :0.6085   Max.   :0.50521               Max.   :0.8197  \n                                                                \n Dystopia Residual\n Min.   :0.8179   \n 1st Qu.:2.0317   \n Median :2.2907   \n Mean   :2.3258   \n 3rd Qu.:2.6646   \n Max.   :3.8377   \n                  \n```\n:::\n:::\n\n- How many countries are in the region \"Western Europe\"?\n    + __21__\n- What is the maximum number in the \"Happiness Score\" column?\n    + __7.526__\n- From the columns \"Economy (GDP per Capital)\" to \"Dystopia Residual\", which has the highest mean and which has the lowest?\n    + __Highest: \"Dystopia Residual\" with 2.3258__\n    + __Lowest: \"Family\" with 0.13762__\n\n3.Produce the plot\n\n::: {.cell}\n\n```{.r .cell-code}\n#Fit linear model of Economy (x) against Family (y)\nfit_economy_family <- \n  lm(Family~`Economy (GDP per Capita)`, data = happy_df)\n#Create string for linear equation\nc <- round(fit_economy_family$coefficients[1], digits = 4)\nm <- round(fit_economy_family$coefficients[2], digits = 4)\nlm_equation <- paste0(\"y = \", m , \"x + \", c)\n#Produce plot\nplot(x = happy_df$`Economy (GDP per Capita)`,\n     y = happy_df$Family,\n     main = \"Comparison of the effect of \\n Economy and Family on happiness\",\n     xlab = \"Economy (GDP per Capita)\",\n     ylab = \"Family\",\n     pch = as.numeric(happy_df$Region),\n     xlim = c(0,2), ylim = c(0,1.5),\n     col = 1)\n#Add abline\nabline(fit_economy_family, col = \"mediumslateblue\")\n#Add equation to top right\ntext(x = 0.4, y = 1.1, labels = lm_equation)\n#Add the legend\nlegend(x = \"bottomright\",\n       pch = 1:nlevels(happy_df$Region),\n       legend = levels(happy_df$Region))\n```\n\n::: {.cell-output-display}\n![](19-Stats_solutions_files/figure-html/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n\n\n4. Save plot as png file\n\n::: {.cell}\n\n```{.r .cell-code}\n#PNG command\npng(filename = \"Chapter_17-18/Economy_vs_family.png\", \n    units = \"in\", height = 8, width = 8, res = 200)\n#Produce plot\nplot(x = happy_df$`Economy (GDP per Capita)`,\n     y = happy_df$Family,\n     main = \"Comparison of the effect of \\n Economy and Family on happiness\",\n     xlab = \"Economy (GDP per Capita)\",\n     ylab = \"Family\",\n     pch = as.numeric(happy_df$Region),\n     xlim = c(0,2), ylim = c(0,1.5),\n     col = 1)\n#Add abline\nabline(fit_economy_family, col = \"mediumslateblue\")\n#Add equation to top right\ntext(x = 0.4, y = 1.1, labels = lm_equation)\n#Add the legend\nlegend(x = \"bottomright\",\n       pch = 1:nlevels(happy_df$Region),\n       legend = levels(happy_df$Region))\n#dev.off\ndev.off()\n```\n:::\n\n\n5. Answers for the following questions:\n- Does the linear model have a positive or negative gradient?\n    + __Positive__ (m = 0.4328)6\n- Which variable (Economy or Family) has higher values?\n    + __Economy__\n- If the value of Economy was 2.1 what would be the predictive value of Family according to the linear model equation?\n    + __(0.4328*2.1) + 0.3808 = 1.28968__\n- Which region appears to have the highest values for Economy and for Family?\n    + __Western Europe__\n\n6. Produce boxplot\n\n::: {.cell}\n\n```{.r .cell-code}\n#Change level names\nshort_region_names <- \n  c(\"OZ_n_NZ\", \"C_n_E_Europe\", \"E_Asia\", \"Latin_A_n_Carib\",\n    \"ME_n_N_Africa\", \"N_America\", \"SE_Asia\", \"S_Asia\",\n    \"Sub_Saharan\", \"W_Europe\")\nlevels(happy_df$Region) <- short_region_names\n#Create boxplot\nboxplot(`Happiness Score`~Region, data = happy_df, \n        ylim = c(0,10),\n        col = 1:nlevels(happy_df$Region),\n        main = \"Happiness scores across regions\"\n)\n```\n\n::: {.cell-output-display}\n![](19-Stats_solutions_files/figure-html/unnamed-chunk-6-1.png){width=1536}\n:::\n:::\n\n\n7. Save as jpeg\n\n::: {.cell}\n\n```{.r .cell-code}\n#jpeg\njpeg(filename = \"Chapter_17-18/Region_happiness_boxplots.jpg\", units = \"px\",\n     width = 1500, height = 750 )\n#Create boxplot\nboxplot(`Happiness Score`~Region, data = happy_df, \n        ylim = c(0,10),\n        col = 1:nlevels(happy_df$Region),\n        main = \"Happiness scores across regions\"\n)\n#dev.off\ndev.off()\n```\n:::\n\n\n8. T-tests\n\n::: {.cell}\n\n```{.r .cell-code}\n#Subset the data frames to get vectors of our regions of interest\nWE_happiness <- happy_df[happy_df$Region == \"W_Europe\",\"Happiness Score\"]\nNA_happiness <- happy_df[happy_df$Region == \"N_America\",\"Happiness Score\"] \nSA_happiness <- happy_df[happy_df$Region == \"S_Asia\",\"Happiness Score\"] \nSEA_happiness <- happy_df[happy_df$Region == \"SE_Asia\",\"Happiness Score\"]\n#Carry out t-tests\nWE_NA_ttest <- t.test(WE_happiness, NA_happiness)\nWE_SA_ttest <- t.test(WE_happiness, SA_happiness)\nSA_SEA_ttest <- t.test(SA_happiness, SEA_happiness)\n#Extract p values into a new vector with element names\nregion_happiness_pvalues <- c(WE_NA = WE_NA_ttest$p.value,\n                              WE_SA = WE_SA_ttest$p.value,\n                              SA_SEA = SA_SEA_ttest$p.value)\n#Logical to determine if the p-value is less than 0.05\n#I.e. the means are significantly different\nregion_happiness_pvalues < 0.05\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n WE_NA  WE_SA SA_SEA \n FALSE   TRUE  FALSE \n```\n:::\n:::\n",
    "supporting": [
      "19-Stats_solutions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}